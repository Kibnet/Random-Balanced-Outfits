<Window
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
	x:Class="Randomizer.MainWindow" Language="Ru"
	Title="Генератор Нарядов" Height="600" MinWidth="400" Width="800" WindowStartupLocation="CenterScreen"
	Icon="DiceRoll.ico"
	WindowState="Maximized">

    <!--<Window.Resources>
		<randomizer:ModelView x:Key="model" />
	</Window.Resources>-->
    <Grid x:Name="MainGrid" DataContext="{StaticResource model}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Menu>
            <MenuItem Header="Открыть..." Click="ОткрытьКак"/>
            <MenuItem Header="Сохранить" Click="СохранитьНастройки"/>
            <MenuItem Header="Сохранить как..." Click="СохранитьКак"/>
            <MenuItem Header="Обновить всё" Click="ОбновитьВсё"/>
            <Slider Name="ZoomSlider" Width="100" Minimum="1" Maximum="4" AutoToolTipPlacement="TopLeft" SmallChange="0.01" Cursor="SizeAll" Value="{Binding Zoom}"/>
        </Menu>
        <syncfusion:BusyIndicator IsBusy="{Binding IsBusy}" CancelButtonVisibility="Collapsed" IsIndeterminate="True" LoadingDescription="{Binding Status}" Header="Распределение Нарядов" Grid.Row="1">
            <ScrollViewer>
                <StackPanel Margin="10">
                    <StackPanel.LayoutTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleX="{Binding ElementName=ZoomSlider, Path=Value}" ScaleY="{Binding ElementName=ZoomSlider, Path=Value}"/>
                            <SkewTransform/>
                            <RotateTransform/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </StackPanel.LayoutTransform>
                    <Expander>
                        <Expander.Header>
                            <StackPanel Orientation="Horizontal">
                                <Label Content="Даты:" Height="24" Padding="0,0,5,0" VerticalContentAlignment="Center" />
                                <Label x:Name="ИтогоДаты" Height="24" Padding="5,0" VerticalContentAlignment="Center" />
                            </StackPanel>
                        </Expander.Header>
                        <StackPanel Orientation="Horizontal" Margin="5,0,5,5">
                            <StackPanel Margin="5,0,5,5">
                                <Label Content="Период Графика" Padding="0" HorizontalAlignment="Center" />
                                <Calendar x:Name="graficDates" 
									  ToolTip="Период Графика. Выбирайте период мышкой. Shift чтобы выбирать непрерывный промежуток. Ctrl чтобы выбирать отдельные даты."
									  SelectionMode="MultipleRange" BorderThickness="0" Height="152" />

                            </StackPanel>
                            <StackPanel Margin="5,0,5,5">
                                <Label Content="Усиления" Padding="0" HorizontalAlignment="Center" />
                                <Calendar x:Name="sealDates"
									  ToolTip="Усиление. Выбирайте период мышкой. Shift чтобы выбирать непрерывный промежуток. Ctrl чтобы выбирать отдельные даты."
									  SelectionMode="MultipleRange" BorderThickness="0" Height="152" />

                            </StackPanel>
                            <StackPanel Margin="5,0,5,5">
                                <Label Content="Выходные и Праздники" Padding="0" HorizontalAlignment="Center" />
                                <Calendar x:Name="holyDates"
									  ToolTip="Выходные и Праздники. Выбирайте период мышкой. Shift чтобы выбирать непрерывный промежуток. Ctrl чтобы выбирать отдельные даты."
									  SelectionMode="MultipleRange" BorderThickness="0" Height="152" />

                            </StackPanel>
                        </StackPanel>
                    </Expander>
                    <Expander>
                        <Expander.Header>
                            <StackPanel Orientation="Horizontal">
                                <Label Content="Наряды:" Height="24" Padding="0,0,5,0" VerticalContentAlignment="Center" />
                                <Label x:Name="ВсегоНарядов" Height="24" Padding="5,0" VerticalContentAlignment="Center" />
                            </StackPanel>
                        </Expander.Header>
                        <Grid Margin="5,0,5,5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5,0,5,5">
                                <Button ToolTip="Добавить Новый Наряд" Height="32" Margin="5" BorderThickness="1" Background="White"
								Click="ДобавитьНаряд">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M19.833,0L32.5,0 32.5,19.833999 52.334,19.833999 52.334,32.500999 32.5,32.500999 32.5,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Редактировать Выделенный Наряд" Height="32" Margin="5" BorderThickness="1" Background="White" Click="РедактироватьНаряд">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M0,44.439791L18.98951,54.569246 0.47998798,62.66881z M17.428029,12.359973L36.955557,23.568769 21.957478,49.686174 20.847757,46.346189 15.11851,45.756407 14.138656,42.166935 8.5292659,41.966761 6.9493899,38.037481 2.4399572,38.477377z M26.812517,0.0009765625C27.350616,-0.012230873,27.875986,0.10826397,28.348372,0.3782568L42.175028,8.3180408C43.85462,9.2780154,44.234529,11.777948,43.02482,13.89789L41.375219,16.767812 21.460039,5.3381228 23.10964,2.4582005C23.979116,0.941679,25.437378,0.034730911,26.812517,0.0009765625z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Удалить Выделенный Наряд" Height="32" Margin="5" BorderThickness="1" Background="White" Click="УдалитьНаряд">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M19.833,0L32.5,0 32.5,19.833999 52.334,19.833999 52.334,32.500999 32.5,32.500999 32.5,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"
										RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform />
                                                        <SkewTransform />
                                                        <RotateTransform Angle="45" />
                                                        <TranslateTransform />
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Переместить Выделенный Наряд Выше" Height="32" Margin="5" BorderThickness="1" Background="White" Click="ВверхНаряд">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M90.3583334740251,0L90.3583334740251,47.8300698141538C271.127895241603,47.8300698141538 285.305019265041,167.585227284857 285.305019265041,191.500998769232 246.30469883047,95.720137868353 90.3583334740251,143.610205922552 90.3583334740251,143.610205922552L90.3583334740251,191.500998769232 0,101.773886952826z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"
										RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <TransformGroup.Children>
                                                            <RotateTransform Angle="90" />
                                                            <ScaleTransform ScaleX="1" ScaleY="1" />
                                                        </TransformGroup.Children>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Переместить Выделенный Наряд Ниже" Height="32" Margin="5" BorderThickness="1" Background="White" Click="ВнизНаряд">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M194.946686588228,0L285.305023990572,101.774623095582 194.946686588228,191.501002490113 194.946686588228,143.610926806519C194.946686588228,143.610926806519 39.0003059729934,95.7808639403083 0,191.501002490113 0,167.585963427613 14.1771210059524,47.8907958861091 194.946686588228,47.8907958861091z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"
										RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <TransformGroup.Children>
                                                            <RotateTransform Angle="90" />
                                                            <ScaleTransform ScaleX="1" ScaleY="1" />
                                                        </TransformGroup.Children>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button Click="Button_ОбновитьНаряды" ToolTip="Обновить Таблицу с Нарядами" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path Data="M9.9315472,30.022331C10.079168,30.036248 10.221069,30.093434 10.334394,30.187184 10.488594,30.314683 10.586294,30.502183 10.601295,30.700082 10.799795,33.215764 11.502995,35.728747 12.771795,38.090732 14.583698,41.460509 17.2738,44.048993 20.411201,45.728681L21.659304,40.895314C21.733402,40.609015 21.970404,40.395316 22.261503,40.351117 22.555004,40.306817 22.842703,40.439616 22.999704,40.689614L27.652707,48.179265 31.78291,54.83022C31.904611,55.054219 31.922311,55.270219 31.851311,55.470815 31.77451,55.684316 31.60521,55.845815 31.39171,55.918714L24.687205,58.166101 15.185999,61.350976C14.901398,61.447377 14.589598,61.361379 14.394197,61.134877 14.195698,60.905679 14.156696,60.585382 14.295897,60.317086L16.627298,55.749516C11.170895,53.153131 6.4619408,48.85896 3.3864975,43.129699 1.4529076,39.533422 0.34676361,35.707849 0.0030136108,31.877173 -0.032814026,31.478776 0.2549057,31.124679 0.65273285,31.077779L9.7828636,30.023086C9.8324966,30.01786,9.8823395,30.017692,9.9315472,30.022331z M50.486482,14.078776C50.651744,14.08645,50.810987,14.150894,50.939912,14.262197L56.238731,18.941983 63.750458,25.574907C63.975758,25.775511 64.05846,26.088017 63.957458,26.369222 63.85976,26.655726 63.601957,26.848432 63.299257,26.864032L58.181438,27.132336C58.661839,33.153247 57.300537,39.379865 53.878623,44.908666 51.731415,48.382733 48.970407,51.255086 45.827196,53.468728 45.500993,53.69793 45.050495,53.627526 44.810191,53.304723L39.329771,45.929585C39.211272,45.768083 39.163874,45.564878 39.193675,45.369573 39.229472,45.171769 39.342273,44.994567 39.504875,44.882668 41.583682,43.452939 43.407289,41.585704 44.819392,39.304461 46.832399,36.049104 47.725003,32.426633 47.612302,28.869268L42.799785,30.205295C42.514784,30.285995 42.212583,30.189591 42.028382,29.957788 41.841583,29.726085 41.812183,29.410979 41.951584,29.147973L46.105896,21.371729 49.798009,14.468001C49.931409,14.251797 50.11231,14.126794 50.320113,14.090393 50.375638,14.079968 50.431395,14.076218 50.486482,14.078776z M29.956733,6.6757202E-06C34.042579,-0.0026788712 37.936724,0.8332386 41.471065,2.3410139 41.841669,2.4999504 42.016671,2.9191303 41.868269,3.2941208L38.478931,11.835634C38.404629,12.020429 38.256928,12.168926 38.072726,12.244424 37.889124,12.320022 37.678121,12.317322 37.497818,12.236624 35.187192,11.221049 32.640363,10.653362 29.956733,10.653363 26.131188,10.653362 22.581547,11.799134 19.616014,13.767887L23.281356,17.155804C23.500858,17.3563 23.577759,17.666192 23.476758,17.944885 23.379157,18.223479 23.123955,18.416174 22.830351,18.434373L14.032049,18.99176 6.2181396,19.483948C5.9629478,19.486448 5.761776,19.39795 5.6224327,19.241754 5.468132,19.072458 5.405632,18.848464 5.4440193,18.624568L6.6334953,11.655937 8.3202744,1.7785282C8.373745,1.4816647 8.5964661,1.2472906 8.8900509,1.1822319 9.1836929,1.1171637 9.4831371,1.2343512 9.6550083,1.4816647L12.576233,5.6951828C17.442289,2.1171398,23.453458,-0.0026788712,29.956733,6.6757202E-06z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Обновить" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                                <Button Click="СохранитьНастройки" ToolTip="Сохранить все настройки в файл Настройки.bin" Height="32" Margin="5" BorderThickness="1" Background="White" >
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox >
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible"/>
                                                <Path Data="M58.087635,37.91074L47.872219,48.125874 43.038265,43.283699 41.153744,45.166451 47.872219,51.884777 59.972256,39.793491z M50.563049,31.73C57.949932,31.73 64,37.779644 64,45.166451 64,52.553158 57.949932,58.603001 50.563049,58.603001 43.176067,58.603001 37.125999,52.553158 37.125999,45.166451 37.125999,37.779644 43.176067,31.73 50.563049,31.73z M33.032001,0L40.381001,0 40.381001,16.236 33.032001,16.236z M5.0388451,0L13.576872,0 13.576872,15.676368C13.576872,17.995482,15.456882,19.875292,17.775993,19.875292L39.191006,19.875292C41.510117,19.875292,43.389931,17.995482,43.389931,15.676368L43.389931,0 49.177559,0 56.966999,7.789382 56.966999,30.375652C55.002491,29.522047 52.83918,29.042944 50.564068,29.042944 41.672218,29.042944 34.440281,36.274784 34.440281,45.166538 34.440281,49.536861 36.193592,53.500183 39.026005,56.407002L5.0388451,56.407002C2.255872,56.407002,0,54.150986,0,51.368172L0,5.038847C0,2.2558709,2.255872,4.6670634E-08,5.0388451,0z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"/>
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Сохранить Настройки" VerticalAlignment="Center" Margin="0,0,5,0" ></TextBlock>
                                    </StackPanel>
                                </Button>

                            </StackPanel>
                            <syncfusion:GridDataControl Grid.Row="1" x:Name="narydsGrid"
												ItemsSource="{Binding Наряды}" AllowEdit="False" ShowAddNewRow="False"
												Margin="5" ColumnSizer="Auto" AutoGenerateColumnsInfo="False"
												AutoPopulateColumns="False" AllowNestedGridPadding="False" ShowRowHeaderArrow="False"
												ShowRecordPlusMinus="False" NotifyComplexPropertyChanges="False" NotifyPropertyChanges="True" BorderThickness="0" >
                                <syncfusion:GridDataControl.VisibleColumns>
                                    <syncfusion:GridDataVisibleColumn MappingName="Название" HeaderText="Наряд" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Длительность" HeaderText="Длительность, ч" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Количество" HeaderText="Всего, шт" />
                                    <syncfusion:GridDataVisibleColumn MappingName="КоличествоВыходных"
															  HeaderText="Выходных, шт" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Всего" HeaderText="Всего, ч" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Выходных" HeaderText="Выходных, ч" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Дни" HeaderText="В какие дни" />
                                    <syncfusion:GridDataVisibleColumn MappingName="РаспределеноКоличество"
															  HeaderText="Распред Всего, шт" />
                                    <syncfusion:GridDataVisibleColumn MappingName="РаспределеноКоличествоВыходных"
															  HeaderText="Распред Выходных, шт" />
                                    <syncfusion:GridDataCheckBoxVisibleColumn MappingName="Усиление"
																	  HeaderText="Только в Усиление" />
                                </syncfusion:GridDataControl.VisibleColumns>
                            </syncfusion:GridDataControl>

                        </Grid>
                    </Expander>
                    <Expander>
                        <Expander.Header>
                            <StackPanel Orientation="Horizontal">
                                <Label Content="Подразделения:" Height="24" Padding="0,0,5,0" VerticalContentAlignment="Center" />
                                <Label x:Name="Распределено" Height="24" Padding="5,0" VerticalContentAlignment="Center" />
                            </StackPanel>
                        </Expander.Header>
                        <Grid Margin="5,0,5,5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal">
                                <Button ToolTip="Добавить Новое Подразделение" Click="ДобавитьПодразделение" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M19.833,0L32.5,0 32.5,19.833999 52.334,19.833999 52.334,32.500999 32.5,32.500999 32.5,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Редактировать Выделенное Подразделение" Click="РедактироватьПодразделение" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M0,44.439791L18.98951,54.569246 0.47998798,62.66881z M17.428029,12.359973L36.955557,23.568769 21.957478,49.686174 20.847757,46.346189 15.11851,45.756407 14.138656,42.166935 8.5292659,41.966761 6.9493899,38.037481 2.4399572,38.477377z M26.812517,0.0009765625C27.350616,-0.012230873,27.875986,0.10826397,28.348372,0.3782568L42.175028,8.3180408C43.85462,9.2780154,44.234529,11.777948,43.02482,13.89789L41.375219,16.767812 21.460039,5.3381228 23.10964,2.4582005C23.979116,0.941679,25.437378,0.034730911,26.812517,0.0009765625z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button ToolTip="Удалить Выделенное Подразделение" Click="УдалитьПодразделение" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M19.833,0L32.5,0 32.5,19.833999 52.334,19.833999 52.334,32.500999 32.5,32.500999 32.5,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"
										RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform />
                                                        <SkewTransform />
                                                        <RotateTransform Angle="45" />
                                                        <TranslateTransform />
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button Click="КнопкаКалькулятора" ToolTip="Открыть Калькулятор" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <Viewbox>
                                        <Grid>
                                            <Grid Width="40" Height="40" Visibility="Visible" />
                                            <Path
										Data="M485.099,674.957C469.072,674.957,456.119,687.978,456.119,703.998L456.119,733.039C456.119,749.061,469.072,762.069,485.099,762.069L517.681,762.069C533.661,762.069,546.638,749.061,546.638,733.039L546.638,703.998C546.638,687.978,533.661,674.957,517.681,674.957z M307.71,674.957C291.73,674.957,278.754,687.978,278.754,703.998L278.754,733.039C278.754,749.061,291.73,762.069,307.71,762.069L340.277,762.069C356.267,762.069,369.247,749.061,369.247,733.039L369.247,703.998C369.247,687.978,356.267,674.957,340.277,674.957z M130.319,674.957C114.34,674.957,101.362,687.978,101.362,703.998L101.362,733.039C101.362,749.061,114.34,762.069,130.319,762.069L162.901,762.069C178.879,762.069,191.881,749.061,191.881,733.039L191.881,703.998C191.881,687.978,178.879,674.957,162.901,674.957z M485.099,522.549C469.072,522.549,456.119,535.559,456.119,551.565L456.119,580.594C456.119,596.639,469.072,609.647,485.099,609.647L517.681,609.647C533.661,609.647,546.638,596.639,546.638,580.594L546.638,551.565C546.638,535.559,533.661,522.549,517.681,522.549z M307.71,522.549C291.73,522.549,278.754,535.559,278.754,551.565L278.754,580.594C278.754,596.639,291.73,609.647,307.71,609.647L340.277,609.647C356.267,609.647,369.247,596.639,369.247,580.594L369.247,551.565C369.247,535.559,356.267,522.549,340.277,522.549z M130.319,522.549C114.34,522.549,101.362,535.559,101.362,551.565L101.362,580.594C101.362,596.639,114.34,609.647,130.319,609.647L162.901,609.647C178.879,609.647,191.881,596.639,191.881,580.594L191.881,551.565C191.881,535.559,178.879,522.549,162.901,522.549z M485.099,370.116C469.072,370.116,456.119,383.137,456.119,399.157L456.119,428.184C456.119,444.204,469.072,457.202,485.099,457.202L517.681,457.202C533.661,457.202,546.638,444.204,546.638,428.184L546.638,399.157C546.638,383.137,533.661,370.116,517.681,370.116z M307.71,370.116C291.73,370.116,278.754,383.137,278.754,399.157L278.754,428.184C278.754,444.204,291.73,457.202,307.71,457.202L340.277,457.202C356.267,457.202,369.247,444.204,369.247,428.184L369.247,399.157C369.247,383.137,356.267,370.116,340.277,370.116z M130.319,370.116C114.34,370.116,101.362,383.137,101.362,399.157L101.362,428.184C101.362,444.204,114.34,457.202,130.319,457.202L162.901,457.202C178.879,457.202,191.881,444.204,191.881,428.184L191.881,399.157C191.881,383.137,178.879,370.116,162.901,370.116z M133.943,101.565C109.997,101.565,90.4942,121.093,90.4942,145.097L90.4942,243.104C90.4942,267.133,109.997,286.647,133.943,286.647L514.057,286.647C538.03,286.647,557.505,267.133,557.505,243.104L557.505,145.097C557.505,121.093,538.03,101.565,514.057,101.565z M108.583,0L539.416,0C599.269,-4E-06,648,48.8053,648,108.828L648,791.112C648,851.122,599.269,900,539.416,900L108.583,900C48.7316,900,-3E-06,851.122,0,791.112L0,108.828C-3E-06,48.8053,48.7316,-4E-06,108.583,0z"
										Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <Button Click="Button_ОбновитьПодразделения" ToolTip="Обновить Таблицу с Подразделениями" Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path Data="M9.9315472,30.022331C10.079168,30.036248 10.221069,30.093434 10.334394,30.187184 10.488594,30.314683 10.586294,30.502183 10.601295,30.700082 10.799795,33.215764 11.502995,35.728747 12.771795,38.090732 14.583698,41.460509 17.2738,44.048993 20.411201,45.728681L21.659304,40.895314C21.733402,40.609015 21.970404,40.395316 22.261503,40.351117 22.555004,40.306817 22.842703,40.439616 22.999704,40.689614L27.652707,48.179265 31.78291,54.83022C31.904611,55.054219 31.922311,55.270219 31.851311,55.470815 31.77451,55.684316 31.60521,55.845815 31.39171,55.918714L24.687205,58.166101 15.185999,61.350976C14.901398,61.447377 14.589598,61.361379 14.394197,61.134877 14.195698,60.905679 14.156696,60.585382 14.295897,60.317086L16.627298,55.749516C11.170895,53.153131 6.4619408,48.85896 3.3864975,43.129699 1.4529076,39.533422 0.34676361,35.707849 0.0030136108,31.877173 -0.032814026,31.478776 0.2549057,31.124679 0.65273285,31.077779L9.7828636,30.023086C9.8324966,30.01786,9.8823395,30.017692,9.9315472,30.022331z M50.486482,14.078776C50.651744,14.08645,50.810987,14.150894,50.939912,14.262197L56.238731,18.941983 63.750458,25.574907C63.975758,25.775511 64.05846,26.088017 63.957458,26.369222 63.85976,26.655726 63.601957,26.848432 63.299257,26.864032L58.181438,27.132336C58.661839,33.153247 57.300537,39.379865 53.878623,44.908666 51.731415,48.382733 48.970407,51.255086 45.827196,53.468728 45.500993,53.69793 45.050495,53.627526 44.810191,53.304723L39.329771,45.929585C39.211272,45.768083 39.163874,45.564878 39.193675,45.369573 39.229472,45.171769 39.342273,44.994567 39.504875,44.882668 41.583682,43.452939 43.407289,41.585704 44.819392,39.304461 46.832399,36.049104 47.725003,32.426633 47.612302,28.869268L42.799785,30.205295C42.514784,30.285995 42.212583,30.189591 42.028382,29.957788 41.841583,29.726085 41.812183,29.410979 41.951584,29.147973L46.105896,21.371729 49.798009,14.468001C49.931409,14.251797 50.11231,14.126794 50.320113,14.090393 50.375638,14.079968 50.431395,14.076218 50.486482,14.078776z M29.956733,6.6757202E-06C34.042579,-0.0026788712 37.936724,0.8332386 41.471065,2.3410139 41.841669,2.4999504 42.016671,2.9191303 41.868269,3.2941208L38.478931,11.835634C38.404629,12.020429 38.256928,12.168926 38.072726,12.244424 37.889124,12.320022 37.678121,12.317322 37.497818,12.236624 35.187192,11.221049 32.640363,10.653362 29.956733,10.653363 26.131188,10.653362 22.581547,11.799134 19.616014,13.767887L23.281356,17.155804C23.500858,17.3563 23.577759,17.666192 23.476758,17.944885 23.379157,18.223479 23.123955,18.416174 22.830351,18.434373L14.032049,18.99176 6.2181396,19.483948C5.9629478,19.486448 5.761776,19.39795 5.6224327,19.241754 5.468132,19.072458 5.405632,18.848464 5.4440193,18.624568L6.6334953,11.655937 8.3202744,1.7785282C8.373745,1.4816647 8.5964661,1.2472906 8.8900509,1.1822319 9.1836929,1.1171637 9.4831371,1.2343512 9.6550083,1.4816647L12.576233,5.6951828C17.442289,2.1171398,23.453458,-0.0026788712,29.956733,6.6757202E-06z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Обновить" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <Button Click="СохранитьСтатистику" ToolTip="Сохранить Статистику Подразделений в Word-файл"
								Height="32" Margin="5" BorderThickness="1" Background="White">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path
											Data="M29.601601,19.605532L25.4193,19.965033 22.862,35.799561 19.542999,20.510435 15.6211,20.510435 12.6028,35.095158 10.3398,20.912834 6.8203106,20.912834 10.4909,40.979267 14.4636,41.079567 17.380199,26.948046 20.75,41.532669 24.873699,41.532669z M38.250999,7.0340004L63.19529,7.0340004C63.640594,7.0340004,64,7.3934326,64,7.8374653L64,53.400093C64,53.845497,63.640594,54.204998,63.19529,54.204998L38.250999,54.204998 38.250999,47.969154 58.065029,47.969154 58.065029,45.354633 38.250999,45.354633 38.250999,41.532909 58.065029,41.532909 58.065029,38.916988 38.250999,38.916988 38.250999,35.09536 58.065029,35.09536 58.065029,32.480843 38.250999,32.480843 38.250999,28.657816 58.065029,28.657816 58.065029,26.043297 38.250999,26.043297 38.250999,22.22147 58.065029,22.22147 58.065029,19.60565 38.250999,19.60565 38.250999,15.784023 58.065029,15.784023 58.065029,13.168104 38.250999,13.168104z M37.013,0L37.013,61.288002 0,54.850391 0,6.1693802z"
											Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Сохранить Статистику..." VerticalAlignment="Center" Margin="0,0,5,0" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                            <syncfusion:GridDataControl x:Name="districtsGrid" Margin="5" ItemsSource="{Binding Подразделения}"
												AllowEdit="False" ShowAddNewRow="False"
												LayoutUpdated="DistrictsGridLayoutUpdated" Grid.Row="1" ColumnSizer="Auto" AutoGenerateColumnsInfo="False"
												AutoPopulateColumns="False" AllowSort="True"
												AutoPopulateRelations="False" BorderThickness="0,0,1,0">
                                <syncfusion:GridDataControl.SortColumns>
                                    <syncfusion:GridDataSortColumn ColumnName="Название"/>
                                </syncfusion:GridDataControl.SortColumns>
                                <syncfusion:GridDataControl.VisibleColumns>
                                    <syncfusion:GridDataVisibleColumn MappingName="Название" HeaderText="Подразделение" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Люди" HeaderText="Людей, чел" />
                                    <syncfusion:GridDataPercentEditVisibleColumn MappingName="Процент"/>
                                    <syncfusion:GridDataVisibleColumn MappingName="Часы" HeaderText="Всего, ч" />
                                    <syncfusion:GridDataVisibleColumn MappingName="ВыходныеЧасы" HeaderText="Выходных, ч" />
                                    <syncfusion:GridDataVisibleColumn MappingName="РаспредЧ" HeaderText="ч=шт;" />
                                    <syncfusion:GridDataVisibleColumn MappingName="Загруженность" HeaderText="Нагр., ч/чел" />
                                    <syncfusion:GridDataVisibleColumn MappingName="ЗагруженностьВыходных" HeaderText="Нагр.Вых., ч/чел" />
                                    <syncfusion:GridDataPercentEditVisibleColumn MappingName="ОтклонениеЗагруженности" HeaderText="Откл.Нагр., %" />
                                    <syncfusion:GridDataPercentEditVisibleColumn MappingName="ОтклонениеЗагруженностиВыходных" HeaderText="Откл.Нагр.Вых., %" />
                                    <syncfusion:GridDataVisibleColumn MappingName="СписокНарядов" HeaderText="Доступные Наряды" />
                                </syncfusion:GridDataControl.VisibleColumns>
                                <syncfusion:GridDataControl.ConditionalFormats>
                                    <syncfusion:GridDataConditionalFormat Name="C1" ApplyStyleToColumn="ОтклонениеЗагруженности">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#1900FC00" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженности"
                                                          ConditionType="GreaterThan"
                                                          Value="-0,15" />
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженности"
                                                          ConditionType="LessThan"
                                                          Value="0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>
                                    <syncfusion:GridDataConditionalFormat Name="C2" ApplyStyleToColumn="ОтклонениеЗагруженности">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#19FF0000" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженности"
                                                          ConditionType="GreaterThan"
                                                          Value="0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>
                                    <syncfusion:GridDataConditionalFormat Name="C3" ApplyStyleToColumn="ОтклонениеЗагруженности">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#190000FF" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженности"
                                                          ConditionType="LessThan"
                                                          Value="-0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>

                                    <syncfusion:GridDataConditionalFormat Name="D1" ApplyStyleToColumn="ОтклонениеЗагруженностиВыходных">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#1900FC00" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженностиВыходных"
                                                          ConditionType="GreaterThan"
                                                          Value="-0,15" />
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженностиВыходных"
                                                          ConditionType="LessThan"
                                                          Value="0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>
                                    <syncfusion:GridDataConditionalFormat Name="D2" ApplyStyleToColumn="ОтклонениеЗагруженностиВыходных">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#19FF0000" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженностиВыходных"
                                                          ConditionType="GreaterThan"
                                                          Value="0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>
                                    <syncfusion:GridDataConditionalFormat Name="D3" ApplyStyleToColumn="ОтклонениеЗагруженностиВыходных">
                                        <syncfusion:GridDataConditionalFormat.Style>
                                            <syncfusion:GridDataStyleInfo Background="#190000FF" />
                                        </syncfusion:GridDataConditionalFormat.Style>
                                        <syncfusion:GridDataConditionalFormat.Conditions>
                                            <syncfusion:GridDataCondition ColumnName="ОтклонениеЗагруженностиВыходных"
                                                          ConditionType="LessThan"
                                                          Value="-0,15" />
                                        </syncfusion:GridDataConditionalFormat.Conditions>
                                    </syncfusion:GridDataConditionalFormat>
                                </syncfusion:GridDataControl.ConditionalFormats>
                            </syncfusion:GridDataControl>
                        </Grid>
                    </Expander>
                    <Expander Header="График">
                        <Grid Margin="5,0,5,5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal" Margin="0">
                                <Button Height="32" Margin="5"
								Click="Button_Генерировать" ToolTip="Распредилить все НЕзаблокированные Наряды между всеми Подразделениями с балансировкой нагрузки" Background="#00DDDDDD" BorderThickness="1">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path Data="M9.9315472,30.022331C10.079168,30.036248 10.221069,30.093434 10.334394,30.187184 10.488594,30.314683 10.586294,30.502183 10.601295,30.700082 10.799795,33.215764 11.502995,35.728747 12.771795,38.090732 14.583698,41.460509 17.2738,44.048993 20.411201,45.728681L21.659304,40.895314C21.733402,40.609015 21.970404,40.395316 22.261503,40.351117 22.555004,40.306817 22.842703,40.439616 22.999704,40.689614L27.652707,48.179265 31.78291,54.83022C31.904611,55.054219 31.922311,55.270219 31.851311,55.470815 31.77451,55.684316 31.60521,55.845815 31.39171,55.918714L24.687205,58.166101 15.185999,61.350976C14.901398,61.447377 14.589598,61.361379 14.394197,61.134877 14.195698,60.905679 14.156696,60.585382 14.295897,60.317086L16.627298,55.749516C11.170895,53.153131 6.4619408,48.85896 3.3864975,43.129699 1.4529076,39.533422 0.34676361,35.707849 0.0030136108,31.877173 -0.032814026,31.478776 0.2549057,31.124679 0.65273285,31.077779L9.7828636,30.023086C9.8324966,30.01786,9.8823395,30.017692,9.9315472,30.022331z M50.486482,14.078776C50.651744,14.08645,50.810987,14.150894,50.939912,14.262197L56.238731,18.941983 63.750458,25.574907C63.975758,25.775511 64.05846,26.088017 63.957458,26.369222 63.85976,26.655726 63.601957,26.848432 63.299257,26.864032L58.181438,27.132336C58.661839,33.153247 57.300537,39.379865 53.878623,44.908666 51.731415,48.382733 48.970407,51.255086 45.827196,53.468728 45.500993,53.69793 45.050495,53.627526 44.810191,53.304723L39.329771,45.929585C39.211272,45.768083 39.163874,45.564878 39.193675,45.369573 39.229472,45.171769 39.342273,44.994567 39.504875,44.882668 41.583682,43.452939 43.407289,41.585704 44.819392,39.304461 46.832399,36.049104 47.725003,32.426633 47.612302,28.869268L42.799785,30.205295C42.514784,30.285995 42.212583,30.189591 42.028382,29.957788 41.841583,29.726085 41.812183,29.410979 41.951584,29.147973L46.105896,21.371729 49.798009,14.468001C49.931409,14.251797 50.11231,14.126794 50.320113,14.090393 50.375638,14.079968 50.431395,14.076218 50.486482,14.078776z M29.956733,6.6757202E-06C34.042579,-0.0026788712 37.936724,0.8332386 41.471065,2.3410139 41.841669,2.4999504 42.016671,2.9191303 41.868269,3.2941208L38.478931,11.835634C38.404629,12.020429 38.256928,12.168926 38.072726,12.244424 37.889124,12.320022 37.678121,12.317322 37.497818,12.236624 35.187192,11.221049 32.640363,10.653362 29.956733,10.653363 26.131188,10.653362 22.581547,11.799134 19.616014,13.767887L23.281356,17.155804C23.500858,17.3563 23.577759,17.666192 23.476758,17.944885 23.379157,18.223479 23.123955,18.416174 22.830351,18.434373L14.032049,18.99176 6.2181396,19.483948C5.9629478,19.486448 5.761776,19.39795 5.6224327,19.241754 5.468132,19.072458 5.405632,18.848464 5.4440193,18.624568L6.6334953,11.655937 8.3202744,1.7785282C8.373745,1.4816647 8.5964661,1.2472906 8.8900509,1.1822319 9.1836929,1.1171637 9.4831371,1.2343512 9.6550083,1.4816647L12.576233,5.6951828C17.442289,2.1171398,23.453458,-0.0026788712,29.956733,6.6757202E-06z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5" >
                                                    <Path.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform ScaleY="1" ScaleX="-1"/>
                                                            <SkewTransform AngleY="0" AngleX="0"/>
                                                            <RotateTransform Angle="0"/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Path.RenderTransform>
                                                </Path>
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Распределить Наряды" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                                <Button
                            ToolTip="Открывает диалоговое окно для выбора пути и имени файла графика в формате Word"
								Height="32" Margin="5" Background="#00DDDDDD" BorderThickness="1"
								Click="СохранитьГрафикНарядов">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path
											Data="M29.601601,19.605532L25.4193,19.965033 22.862,35.799561 19.542999,20.510435 15.6211,20.510435 12.6028,35.095158 10.3398,20.912834 6.8203106,20.912834 10.4909,40.979267 14.4636,41.079567 17.380199,26.948046 20.75,41.532669 24.873699,41.532669z M38.250999,7.0340004L63.19529,7.0340004C63.640594,7.0340004,64,7.3934326,64,7.8374653L64,53.400093C64,53.845497,63.640594,54.204998,63.19529,54.204998L38.250999,54.204998 38.250999,47.969154 58.065029,47.969154 58.065029,45.354633 38.250999,45.354633 38.250999,41.532909 58.065029,41.532909 58.065029,38.916988 38.250999,38.916988 38.250999,35.09536 58.065029,35.09536 58.065029,32.480843 38.250999,32.480843 38.250999,28.657816 58.065029,28.657816 58.065029,26.043297 38.250999,26.043297 38.250999,22.22147 58.065029,22.22147 58.065029,19.60565 38.250999,19.60565 38.250999,15.784023 58.065029,15.784023 58.065029,13.168104 38.250999,13.168104z M37.013,0L37.013,61.288002 0,54.850391 0,6.1693802z"
											Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" />
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Text="Сохранить График..." Margin="0,0,5,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                                <ToggleButton Height="32" Margin="5" Background="#00DDDDDD" BorderThickness="1" ToolTip="Заблокировать/Разблокировать все Наряды в Графике"
									  Checked="ToggleButton_Заблокировать" Unchecked="ToggleButton_Разблокировать">
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox>
                                            <Grid>
                                                <Grid Width="40" Height="40" Visibility="Visible" />
                                                <Path Name="BlockPath" Data="M216.703,392.021C193.561,392.021 174.807,411.285 174.807,435.042 174.807,452.242 184.785,466.809 198.999,473.715L198.999,532.389 234.509,532.389 234.509,473.679C248.741,466.809 258.736,452.188 258.736,435.042 258.736,411.285 239.948,392.021 216.703,392.021z M210.842,49.7245C152.579,49.7245,105.378,101.086,105.378,164.42L105.378,224.989C105.378,232.632,106.107,240.089,107.412,247.346L314.373,247.346C315.695,240.089,316.406,232.632,316.406,224.989L316.406,164.42C316.406,101.086,269.104,49.7245,210.842,49.7245z M210.842,0C289.096,0,352.577,68.9881,352.577,154.05L352.577,235.357C352.577,240.478 352.324,245.541 351.883,250.552 392.001,261.601 421.768,301.065 421.768,348.137L421.768,553.033C421.768,608.65,380.243,653.768,329.096,653.768L92.6889,653.768C41.4571,653.768,2E-06,608.65,0,553.033L0,348.137C2E-06,301.047 29.7501,261.601 69.9193,250.531 69.4788,245.541 69.2245,240.478 69.2245,235.357L69.2245,154.05C69.2245,68.9881,132.604,0,210.842,0z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"/>
                                                <Path Name="UnblockPath" Data="M203.525,384.367C171.302,384.367 145.187,410.776 145.187,443.41 145.187,466.974 159.089,486.982 178.893,496.447L178.893,576.966 228.303,576.966 228.303,496.386C248.128,486.982 262.011,466.916 262.011,443.41 262.011,410.776 235.877,384.367 203.525,384.367z M173.095,0.026592C230.856,-1.13639,285.772,35.9198,307.857,97.0085L334.901,171.741C339.245,183.772,341.936,196.022,343.29,208.232L304.405,207.756C303.607,197.197,301.435,186.557,297.704,176.215L277.584,120.494C256.536,62.3456 195.469,33.3912 141.085,55.9624 86.7001,78.4936 59.7858,143.919 80.8532,202.168L99.284,253.217 284.378,253.217 341.955,253.952C341.936,254.071 341.917,254.171 341.917,254.29 387.039,260.992 421.768,302.375 421.768,352.527L421.768,554.436C421.768,609.281,380.302,653.768,329.092,653.768L92.677,653.768C41.5216,653.768,2E-06,609.281,0,554.436L0,352.527C2E-06,309.058,26.1528,272.169,62.4584,258.744L43.6196,206.642C15.388,128.449 51.6382,40.5512 124.565,10.3041 140.526,3.67424 156.922,0.35222 173.095,0.026592z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0" Visibility="Hidden"/>
                                            </Grid>
                                        </Viewbox>
                                        <TextBlock Name="AllBlock" Text="Заблокировать Все" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </ToggleButton>
                                <CheckBox IsChecked="{Binding ИсключитьБлокированные}" ToolTip="Если включено, то в таблице отображаются расчёты только для незаблокированных нарядов"
								  Content="Исключить заблокированные из расчётов" VerticalAlignment="Center" VerticalContentAlignment="Center" />

                            </StackPanel>
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5,0,5,0">
                                <Label Content="Дата" Width="100" />
                                <ListView ItemsSource="{Binding Наряды}" BorderThickness="0" Background="{x:Null}">
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel IsItemsHost="True" Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Width="100" Content="{Binding Название}" Margin="0" />
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </StackPanel>
                            <ListView Grid.Row="2" x:Name="GraphList" ItemsSource="{Binding ДатыГрафика}" BorderThickness="0"
							  Margin="5,0,5,5" Background="{x:Null}">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Background="{Binding BackColor}" Margin="0">
                                            <Label Content="{Binding Display}" Width="100" />
                                            <!--<TextBlock Text="{Binding Display}" Width="100" VerticalAlignment="Center" TextAlignment="Center" />-->
                                            <ListView ItemsSource="{Binding Подразделения}" BorderThickness="0"
											  Background="Transparent">
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <VirtualizingStackPanel IsItemsHost="True" Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border BorderThickness="0,0,1,0" Width="100" BorderBrush="#FFAAAAAA"
														Margin="0">
                                                            <StackPanel Orientation="Horizontal" Margin="0">
                                                                <syncfusion:ComboBoxAdv Visibility="{Binding Visibility}"
																				SelectedValue="{Binding Pod}"
																				ItemsSource="{Binding All}" Width="85"
																				BorderBrush="{Binding Color}"
																				Background="{Binding Color}" />
                                                                <ToggleButton Width="15" IsChecked="{Binding Locked}"
																	  Visibility="{Binding Visibility}" Background="#00DDDDDD">
                                                                    <ToggleButton.Template>
                                                                        <ControlTemplate TargetType="{x:Type ButtonBase}">
                                                                            <Border x:Name="border"
																			Background="{TemplateBinding Background}"
																			SnapsToDevicePixels="True" Opacity="0.0">
                                                                                <ContentPresenter x:Name="contentPresenter"
																						  ContentTemplate="{TemplateBinding ContentTemplate}"
																						  Content="{TemplateBinding Content}"
																						  ContentStringFormat="{TemplateBinding ContentStringFormat}"
																						  Focusable="False"
																						  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
																						  Margin="{TemplateBinding Padding}"
																						  RecognizesAccessKey="True"
																						  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
																						  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                                                            </Border>
                                                                            <ControlTemplate.Triggers>
                                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                                    <Setter Property="Opacity"
																					TargetName="border" Value="0.5" />
                                                                                </Trigger>
                                                                                <Trigger Property="ToggleButton.IsChecked"
																				 Value="True">
                                                                                    <Setter Property="Opacity"
																					TargetName="border" Value="1" />
                                                                                </Trigger>
                                                                            </ControlTemplate.Triggers>
                                                                        </ControlTemplate>
                                                                    </ToggleButton.Template>
                                                                    <Viewbox>
                                                                        <Path Data="M216.703,392.021C193.561,392.021 174.807,411.285 174.807,435.042 174.807,452.242 184.785,466.809 198.999,473.715L198.999,532.389 234.509,532.389 234.509,473.679C248.741,466.809 258.736,452.188 258.736,435.042 258.736,411.285 239.948,392.021 216.703,392.021z M210.842,49.7245C152.579,49.7245,105.378,101.086,105.378,164.42L105.378,224.989C105.378,232.632,106.107,240.089,107.412,247.346L314.373,247.346C315.695,240.089,316.406,232.632,316.406,224.989L316.406,164.42C316.406,101.086,269.104,49.7245,210.842,49.7245z M210.842,0C289.096,0,352.577,68.9881,352.577,154.05L352.577,235.357C352.577,240.478 352.324,245.541 351.883,250.552 392.001,261.601 421.768,301.065 421.768,348.137L421.768,553.033C421.768,608.65,380.243,653.768,329.096,653.768L92.6889,653.768C41.4571,653.768,2E-06,608.65,0,553.033L0,348.137C2E-06,301.047 29.7501,261.601 69.9193,250.531 69.4788,245.541 69.2245,240.478 69.2245,235.357L69.2245,154.05C69.2245,68.9881,132.604,0,210.842,0z" Stretch="Uniform" Fill="#FF000000" Width="26" Height="26" Margin="0,0,0,0"/>
                                                                    </Viewbox>
                                                                </ToggleButton>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </syncfusion:BusyIndicator>

        <Label HorizontalAlignment="Right" VerticalAlignment="Top" Content="© Платонов Павел Игоревич (Kibnet), Шкотово 2015"
			   Foreground="#7F000000" Margin="0,0,17,0" FontSize="10" Grid.RowSpan="2" />
    </Grid>
</Window>